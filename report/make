#!/usr/bin/env bash

SCRIPT_PATH=$(cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd)
SCRIPT_NAME=$(basename $0)

(
cd "$SCRIPT_PATH"
echo "now working from directory: \"$(pwd -P)\""

#MKCMD="latexmk DVG001_lab2 -outdir=build -pdf -pdflatex=\"pdflatex -shell-escape -interaction=nonstopmode\""
latexmk DVG001_lab2 -outdir=build -pdf -pdflatex="pdflatex -interaction=nonstopmode -shell-escape"
latexmk DVG001_lab2 -outdir=build -pdf -pdflatex="pdflatex -interaction=nonstopmode -shell-escape"
latexmk DVG001_lab2 -outdir=build -pdf -pdflatex="pdflatex -interaction=nonstopmode -shell-escape"

notify-send "DONE MAKING PDF" "latexmk returned: $?"

pdf_file=$(find ./build -type f -name "*.pdf")
pdf_file_is_open=$(ps aux | grep "$pdf_file" | grep -v grep)

if [ -z $pdf_file_is_open ]
then
    notify-send "$SCRIPT_NAME" "Opening pdf file with default viewer .."
    xdg-open "$pdf_file"
else
    notify-send "$SCRIPT_NAME" "pdf updated"
fi

#$MKCMD
#$MKCMD
#$MKCMD
)

